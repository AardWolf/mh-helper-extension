!function(){if(location.href.indexOf("mousehuntgame.com")<0)alert("You are not on mousehuntgame.com! Please try again.");else{var o="https://tsitu.github.io/MH-Tools/setup.html",r=4e3,e=30,n=500,a=[],c=[],i=[],u=0,l=0,s=0,m=document.querySelector("a.campPage-trap-armedItem.base"),g=document.querySelector("a.campPage-trap-armedItem.weapon"),h=document.querySelector("a.campPage-trap-armedItem.trinket"),p=window.open("","mhsetup");if(p.location=o,!(m&&g&&h))throw p.close(),alert("Please ensure that you have FreshCoat enabled in Support -> User Preferences, then navigate to the Camp page!"),new Error("Please ensure that you have FreshCoat enabled in Support -> User Preferences, then navigate to the Camp page!");!function(){m.click();var e=setTimeout(function(){throw p.close(),clearInterval(t),alert("Initial XHR timed out! Please check your connection and try again."),new Error("Initial XHR timed out! Please check your connection and try again.")},r),t=setInterval(function(){document.querySelector("div.campPage-trap-itemBrowser.base")&&(clearTimeout(e),clearInterval(t),function(){function e(){var e=document.querySelectorAll(".campPage-trap-itemBrowser-items .campPage-trap-itemBrowser-item-name"),t=Array.prototype.map.call(e,function(e){return e.textContent}),n=t.filter(function(e,t,n){return t==n.indexOf(e)});return n}m.click(),a=e(),console.log("Number of bases: "+a.length),g.click(),c=e(),console.log("Number of weapons: "+c.length),h.click(),i=e(),console.log("Number of charms: "+i.length);var t=document.querySelector("a.campPage-trap-blueprint-closeButton");t&&t.click(),s=l=u=0,setTimeout(f,n)}())},100)}()}function t(e,t){var n=o+"?"+e+"=";n+=encodeURIComponent(t.join("/")),n+="/",p.location.href=n}function f(){w(function(){u<a.length?(t("bases",a.slice(u,u+e)),u+=e,setTimeout(f,n)):d()})}function d(){w(function(){l<c.length?(t("weapons",c.slice(l,l+e)),l+=e,setTimeout(d,n)):y()})}function y(){w(function(){s<i.length?(t("charms",i.slice(s,s+e)),s+=e,setTimeout(y,n)):p.location.href=o})}function w(t){var n=setTimeout(function(){throw p.close(),alert("Ping XHR timed out! Please check your connection and try again."),new Error("Ping XHR timed out! Please check your connection and try again.")},r),o=(new Date).getTime(),e="?nnn="+o,a=new XMLHttpRequest;a.open("GET","//www.mousehuntgame.com"+e,!0),a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){clearTimeout(n);var e=(new Date).getTime()-o;console.log("Ping time: "+e+"ms"),t&&t()}};try{a.send(null)}catch(e){console.log("Exception:",e)}}}();